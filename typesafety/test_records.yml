---
- case: no_error_true
  parametrized:
    - level: info
    - level: debug
    - level: error
    - level: trace
  main: |
    from loguru import logger

    LOG = logger.opt(record=True)

    LOG.{{ level }}('test')
    LOG.{{ level }}('r={record["line"]}')
    LOG.{{ level }}('{record["line"]}')
  out: |
    main:5: note: Logger configured with record=True is not using record structure
- case: no_error_false
  main: |
    from loguru import logger

    logger.opt(record=False).info('test')
- case: record_in_kwargs
  parametrized:
    - record: "True"
      out: "main:4: error: Logger with record=True cannot override record structure [logger-record]"
    - record: "False"
      out: "main:4: error: Logger is accessing record structure without record=True [logger-record]"
  main: |
    from loguru import logger

    logger.opt(record={{ record  }}).info(
      'line is {record["line"]}',
      record={
        'line': 1,
      },
    )
  out: "{{ out }}"
- case: record_keys
  parametrized:
    - key: foo
      out: "Logger record structure does not contain {{ key }} key"
    - key: line
      out: ""
    - key: exception
      out: ""
    - key: elapsed
      out: ""
    - key: elapsedd
      out: "Logger record structure does not contain {{ key }} key"
    - key: exception
      out: ""
    - key: extra
      out: ""
    - key: file
      out: ""
    - key: function
      out: ""
    - key: level
      out: ""
    - key: line
      out: ""
    - key: message
      out: ""
    - key: module
      out: ""
    - key: name
      out: ""
    - key: process
      out: ""
    - key: odin
      out: "Logger record structure does not contain {{ key }} key"
    - key: thread
      out: ""
    - key: time
      out: ""
  main: |
    from loguru import logger

    logger.opt(record=True).info(
      'Accessing record["{{ key }}"] makes for error={yes_no}',
      yes_no=len('{{ out }}') != 0,
    )
  out: "{{ out }}"
