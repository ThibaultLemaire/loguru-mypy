---
- case: no_error_true
  parametrized:
    - level: info
    - level: debug
    - level: error
    - level: trace
  main: |
    from loguru import logger

    LOG = logger.opt(record=True)

    LOG.{{ level }}('test')
    LOG.{{ level }}('r={record[line]}')
    LOG.{{ level }}('{record[line]}')
  out: |
    main:5: note: Logger configured with record=True is not using record structure
- case: no_error_false
  parametrized:
    - level: info
    - level: debug
    - level: error
    - level: trace
  main: |
    from loguru import logger

    logger.opt(record=False).{{ level  }}('test')
- case: record_kwargs_true
  main: |
    from loguru import logger

    logger.opt(record=True).info('line is {record[line]}')
    logger.debug('No warning for this {record}', record=1990)
  out: |
    main:4: error: record keyword argument cannot override record structure  [logger-kwarg]
- case: record_kwargs_false
  parametrized:
    - severity: info
    - severity: debug
    - severity: warning
    - severity: error
    - severity: exception
  main: |
    from loguru import logger

    logger.opt(record=False).{{ severity }}('{record[foo]}', record={'foo': 1})

    LOG = logger.opt(record=False, lazy=True)
    LOG.{{ severity  }}('lazy is {record[bar]}', record=lambda: {'bar': 2})
- case: record_keys_errors
  parametrized:
    - key: foo
    - key: elapsedd
    - key: odin
  main: |
    from loguru import logger

    logger.opt(record=True).info(
      'Accessing {record[{{ key }}]} makes for error={yes_no}',
      yes_no=len('{{ out }}') != 0,
    )
  out: |
    main:4: error: Logger record structure does not contain {{ key }} key  [logger-record]
- case: record_keys_ok
  parametrized:
    - key: exception
    - key: elapsed
    - key: extra
    - key: file
    - key: function
    - key: level
    - key: line
    - key: message
    - key: module
    - key: name
    - key: process
    - key: thread
    - key: time
  main: |
    from loguru import logger

    logger.opt(record=True).info(
      'Accessing {record[{{ key }}]} makes for error={yes_no}',
      yes_no='no',
    )
